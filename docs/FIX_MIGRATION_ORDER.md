# ä¿®å¤è¿ç§»é¡ºåºé—®é¢˜

## å½“å‰é”™è¯¯

```
Error: relation "Topic" does not exist
```

**åŸå› **ï¼šè¿ç§»æ–‡ä»¶ `20250121000000_add_topic_subtitle` è¯•å›¾ä¿®æ”¹ `Topic` è¡¨ï¼Œä½†è¯¥è¡¨æ˜¯åœ¨ `20251112133920_init` ä¸­åˆ›å»ºçš„ã€‚ç”±äºæ—¶é—´æˆ³ï¼Œ`20250121000000` ä¼šåœ¨ `20251112133920` ä¹‹å‰æ‰§è¡Œã€‚

---

## è§£å†³æ–¹æ¡ˆ

### æ–¹æ¡ˆ 1ï¼šé‡ç½®æ•°æ®åº“å¹¶é‡æ–°è¿è¡Œæ‰€æœ‰è¿ç§»ï¼ˆæ¨èï¼‰

```bash
# è¿›å…¥é¡¹ç›®ç›®å½•
cd /www/wwwroot/www.linkloredu.com

# é‡ç½®æ•°æ®åº“ï¼ˆåˆ é™¤æ‰€æœ‰è¡¨ï¼‰
npx prisma migrate reset --force --schema=../../prisma/schema.prisma

# é‡æ–°è¿è¡Œæ‰€æœ‰è¿ç§»
pnpm prisma:migrate
```

**æ³¨æ„**ï¼šè¿™ä¼šåˆ é™¤æ•°æ®åº“ä¸­çš„æ‰€æœ‰æ•°æ®ï¼å¦‚æœæ•°æ®åº“ä¸­æœ‰é‡è¦æ•°æ®ï¼Œä¸è¦ä½¿ç”¨è¿™ä¸ªæ–¹æ³•ã€‚

### æ–¹æ¡ˆ 2ï¼šæ ‡è®°å¤±è´¥çš„è¿ç§»ä¸ºå·²åº”ç”¨ï¼Œç„¶åç»§ç»­

```bash
# è¿›å…¥é¡¹ç›®ç›®å½•
cd /www/wwwroot/www.linkloredu.com

# æ ‡è®°å¤±è´¥çš„è¿ç§»ä¸ºå·²åº”ç”¨ï¼ˆè·³è¿‡å®ƒï¼‰
npx prisma migrate resolve --applied 20250121000000_add_topic_subtitle --schema=../../prisma/schema.prisma

# ç»§ç»­è¿è¡Œè¿ç§»
pnpm prisma:migrate
```

### æ–¹æ¡ˆ 3ï¼šæ‰‹åŠ¨ä¿®å¤è¿ç§»é¡ºåºï¼ˆå¦‚æœæ•°æ®åº“æ˜¯ç©ºçš„ï¼‰

å¦‚æœæ•°æ®åº“æ˜¯ç©ºçš„ï¼Œå¯ä»¥åˆ é™¤è¿ç§»å†å²å¹¶é‡æ–°åˆ›å»ºï¼š

```bash
# è¿›å…¥é¡¹ç›®ç›®å½•
cd /www/wwwroot/www.linkloredu.com

# åˆ é™¤è¿ç§»å†å²è¡¨
psql -h 127.0.0.1 -U linklore_user -d linklore -c "DROP TABLE IF EXISTS _prisma_migrations;"

# é‡æ–°è¿è¡Œæ‰€æœ‰è¿ç§»
pnpm prisma:migrate
```

---

## æ¨èæ“ä½œï¼ˆæ•°æ®åº“æ˜¯ç©ºçš„ï¼‰

å¦‚æœæ•°æ®åº“æ˜¯ç©ºçš„ï¼ˆæ²¡æœ‰é‡è¦æ•°æ®ï¼‰ï¼Œä½¿ç”¨æ–¹æ¡ˆ 1ï¼š

```bash
cd /www/wwwroot/www.linkloredu.com && \
echo "ğŸ”„ é‡ç½®æ•°æ®åº“å¹¶é‡æ–°è¿è¡Œè¿ç§»..." && \
npx prisma migrate reset --force --schema=../../prisma/schema.prisma && \
echo "" && \
echo "âœ… é‡ç½®å®Œæˆï¼Œç°åœ¨è¿è¡Œè¿ç§»..." && \
pnpm prisma:migrate && \
echo "" && \
echo "âœ… è¿ç§»å®Œæˆï¼"
```

---

## å¦‚æœæ•°æ®åº“æœ‰æ•°æ®ï¼ˆä¸æ¨èé‡ç½®ï¼‰

ä½¿ç”¨æ–¹æ¡ˆ 2ï¼Œè·³è¿‡å¤±è´¥çš„è¿ç§»ï¼š

```bash
cd /www/wwwroot/www.linkloredu.com && \
echo "â­ï¸ æ ‡è®°å¤±è´¥çš„è¿ç§»ä¸ºå·²åº”ç”¨..." && \
npx prisma migrate resolve --applied 20250121000000_add_topic_subtitle --schema=../../prisma/schema.prisma && \
echo "" && \
echo "ğŸ”„ ç»§ç»­è¿è¡Œè¿ç§»..." && \
pnpm prisma:migrate && \
echo "" && \
echo "âœ… è¿ç§»å®Œæˆï¼"
```

---

## æ£€æŸ¥è¿ç§»çŠ¶æ€

```bash
# æŸ¥çœ‹è¿ç§»çŠ¶æ€
npx prisma migrate status --schema=../../prisma/schema.prisma
```

---

## é‡è¦æç¤º

1. **é‡ç½®ä¼šåˆ é™¤æ•°æ®**ï¼š`migrate reset` ä¼šåˆ é™¤æ‰€æœ‰è¡¨å’Œæ•°æ®
2. **å¦‚æœæ˜¯æ–°æ•°æ®åº“**ï¼šå¯ä»¥å®‰å…¨åœ°é‡ç½®
3. **å¦‚æœæœ‰æ•°æ®**ï¼šä½¿ç”¨æ–¹æ¡ˆ 2ï¼Œè·³è¿‡å¤±è´¥çš„è¿ç§»

---

## ä¸‹ä¸€æ­¥

æ ¹æ®ä½ çš„æƒ…å†µé€‰æ‹©ï¼š

- **æ•°æ®åº“æ˜¯ç©ºçš„**ï¼šä½¿ç”¨æ–¹æ¡ˆ 1ï¼ˆé‡ç½®å¹¶é‡æ–°è¿è¡Œï¼‰
- **æ•°æ®åº“æœ‰æ•°æ®**ï¼šä½¿ç”¨æ–¹æ¡ˆ 2ï¼ˆè·³è¿‡å¤±è´¥çš„è¿ç§»ï¼‰

å®Œæˆåå‘Šè¯‰æˆ‘ç»“æœã€‚











